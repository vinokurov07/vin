# PROJECT-3. Предсказание рейтинга отеля

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[3. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[4. Результаты](README.md#Результаты)    
[5. Выводы](README.md#Выводы) 

### Описание проекта  

Существует компания по пронированию отелей Booking. Одна из проблем компании — это нечестные отели, которые накручивают себе рейтинг. Одним из способов нахождения таких отелей является построение модели, которая предсказывает рейтинг отеля. Если предсказания модели сильно отличаются от фактического результата, то, возможно, отель играет нечестно, и его стоит проверить.
Целью данной работы, как видно из названия, является создание модели машинного обучения, которая, основываясь на исходных данных, сможет спрогнозировать оценку отелю.
Исходный датасет, на основе которого будет строиться модель представляет собой набор данных, из 17-ти признаков и 386803 экземпляров данных.
В ходе работы данные исходного датасета будут проанализированы, обработаны, часть из них удалено, а часть новых признаков добавятся.
На основе подготовленного датасета будет произведено обучение модели машинного обучения, и произведена оценка ее эффективности.
В ходе работы используются такие библиотеки как: pandas, numpy, datetime, re, bs4, requests, matplotlib.pyplot, seaborn, timeit, nltk, а так же, различные модули этих библиотек.


:arrow_up:[к оглавлению](README.md#Оглавление)


### Краткая информация о данных

На входе имеем 3 файла - тренировочный датасет, тестовый и файл submission.
Тренировочный датасет содержит 17 признаков, 386803 строки.
Тестовый датасет содержит 16 признаков, 128935 строки. Целевой признак в нем отсутствует.
reviewer_score - целевой признак, который надо предсказать.

Тестовый и тренировочный датасет имеют размеры больше рекомендуемых для загрузки на GitHub, поэтому проект загружен без них. Скачать датасеты можно в задании к соревнованию на Kaggle (https://www.kaggle.com/competitions/sf-booking/data). 
Загрузить в ноутбук датасеты можно двуумя способами: скачав на компьютер (ячейка 4 в ноутбуке) или открыть ноутбук в Kaggle и загрузить данные сразу с сайта (ячейка 5).

Имеющиеся изначально признаки:

hotel_address — адрес отеля;
review_date — дата, когда рецензент разместил соответствующий отзыв;
average_score — средний балл отеля, рассчитанный на основе последнего комментария за последний год;
hotel_name — название отеля;
reviewer_nationality — страна рецензента;
negative_review — отрицательный отзыв, который рецензент дал отелю;
review_total_negative_word_counts — общее количество слов в отрицательном отзыв;
positive_review — положительный отзыв, который рецензент дал отелю;
review_total_positive_word_counts — общее количество слов в положительном отзыве;
reviewer_score — оценка, которую рецензент поставил отелю на основе своего опыта;
total_number_of_reviews_reviewer_has_given — количество отзывов, которые рецензенты дали в прошлом;
total_number_of_reviews — общее количество действительных отзывов об отеле;
tags — теги, которые рецензент дал отелю;
days_since_review — количество дней между датой проверки и датой очистки;
additional_number_of_scoring — есть также некоторые гости, которые просто поставили оценку сервису, но не оставили отзыв. Это число указывает, сколько там действительных оценок без проверки.
lat — географическая широта отеля;
lng — географическая долгота отеля.
  
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  

1. Вводная часть
2. Подготовительный этап
3. Знакомство с данными
4. Работа с пропусками и дубликатами
5. Предобработка данных
6. Работа с признаками
7. Кодирование признаков
8. Проверка распределения данных
9. Нормализация признаков
10. Проверка на мультиколлинеарность
11. Проверка влиятельности признаков на целевую переменную
12. Обучение модели


:arrow_up:[к оглавлению](README.md#Оглавление)


### Результаты
Весь проект выполнен в ноутбуке (https://github.com/vinokurov07/vin/blob/main/SkillFactory/PROJECT-3.%20EDA%20%2B%20Feature%20Engineering.%20%D0%A1%D0%BE%D1%80%D0%B5%D0%B2%D0%BD%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BD%D0%B0%20Kaggle/Project%203.Hotels%20reviews.ipynb)


:arrow_up:[к оглавлению](README.md#Оглавление)


### Выводы:  

Итак, мы рассмотрели базу данных с сайта Booking. Имеющиеся признаки были проверены на дубликаты, пропуски были заполнены. На основании существующих признаков были созданы новые, которые были разнесены на две группы: категориальные и количественные. К количественным отнесены: качество локации на основе географической составляющей, причина поездки, количество ночей, тип комнаты, страна ревьюера, были ли довальны постояльцы локацией отеля, едой, комнатой, ванной, персоналом, техникой и др. факторами, в какой месяц года было путешествие. К количественным признакам отнесены: количество слов в отзывах, средняя оценка на сайте,  средняя оценка по типам комнат,  количество людей в поездке, а также ранги: ранг отеля для каждого города и потчового индекса по уровню средних оценок, ранг отеля для каждого города и потчового индекса по количеству низких оценок, ранг отеля для каждого города и потчового индекса по количеству высоких оценок, ранг популярности отеля по количеству отзывов о нем, рагн отеля по количеству уникальных тэгов. Признаки были проверены на значимость с помощью статистических тестов. Затем категориальные признаки были закодированы. Проведена проверка распределения данных, на основании чего было принято решение о необходимости нормализации и стандартизации данных. После этого проведен отбор признаков для обучения модели. Проведена проверка на мутьтиколлинеарность, а также проверка влиянтя признаков на целевую переменную. Признаки с коэффициентом корреляции более 0.65 и признаки, не влияющие на целевую переменную были удалены. Далее тренировочные данные были разбиты в соотношении 80/20 для обучения и проверки модели. Точность модели оценена по метрике Mean Absolute Percentage Error (MAPE) и показывает среднюю абсолютную процентную ошибку предсказанных значений в отношении фактических. MAPE составила 0.13, что говорит о неплохой точности модели.
Далее, модель предсказала целевой признак на тестовых данных, результаты сохранены в файле 'submission' и загружены на Kaggle. Ссылка на ноутбук в Kaggle: https://www.kaggle.com/code/vinokurov07/hotels-reviews?scriptVersionId=245437062.

:arrow_up:[к оглавлению](README.md#Оглавление)

