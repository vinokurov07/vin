# PROJECT-9. Сегментирование клиентов онлайн-магазина подарков

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[3. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[4. Результаты](README.md#Результаты)    
[5. Выводы](README.md#Выводы) 

### Описание проекта  

В данном проекте решим настоящую бизнес-задачу в области маркетинга. Нужно произвести сегментацию клиентов на основе их покупательской способности, частоты совершения заказов и срока давности последнего заказа, а также определить оптимальную стратегию взаимодействия с ними.

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением электронной коммерции, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/спящие/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д.

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача:** построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Краткая информация о данных

Итак, у нас есть данные о более чем полумиллионе транзакций. Каждая из них описывается следующими признаками:

**Описание набора данных**:
* InvoiceNo — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "C" в начале кода указывает на отмену транзакции);
* Stock Code — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* Description — название товара;
* Quantity — количество каждого товара за транзакцию; 
* InvoiceDate — дата и время выставления счёта/проведения транзакции;
* UnitPrice — цена за единицу товара в фунтах стерлингов;
* CustomerID — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* Country — название страны, в которой проживает клиент.

 
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  

1. Произвести предобработку набора данных.
2. Провести разведывательный анализ данных и выявить основные закономерности.
3. Сформировать категории товаров и клиентов. 
4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
5. Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

**Часть 1. Постановка задачи**

**Часть 2. Знакомство с данными**
 
**Часть 3. Предобработка и очистка данных**
1. Проверка на пропуски, дубликаты.
2. Исследовательский анализ данных, постановка и проверка гипотез.
3. Очистка данных.

**Часть 4. Разведывательный анализ данных:**
1. Понять, клиенты из каких стран покупают больше и чаще;
2. Узнать, присутствует ли в продажах сезонность (когда покупают чаще);
3. Создать новые признаки, которые в дальнейшем понадобятся при формировании датасета о клиентах.

**Часть 5. RFM-сегментация клиентов. Снижение размерности методом PCA:**
1. Провести RFM-анализ клиентов.
2. Применить метод снижения размерности PCA.
3. Подбор оптимального метода кластеризации (KMeans/EM).
4. Визуализация результатов + полярная диаграмма.

**Часть 6. RFM-сегментация клиентов. Снижение размерности методом t-SNE:**
1. Применить метод снижения размерности t-SNE.
2. Подбор оптимального метода кластеризации (KMeans/EM/AgglomerativeClustering).
3. Визуализация результатов + полярная диаграмма.

**Часть 7. RFM-сегментация клиентов. Построение предсказательных моделей:**
1. Пепеход от модели кластеризации к задаче классификации.
2. Построение модели случайного леса, оптимизация гиперпараметров.
3. Построение модели GB над деревьями решений, оптимизация гиперпараметров.

:arrow_up:[к оглавлению](README.md#Оглавление)

### Результаты
[Весь проект выполнен в ноутбуке](</Projects/Project 9.  Сегментирование клиентов онлайн-магазина подарков/Project 9.Сегментирование клиентов онлайн-магазина.ipynb>) 

:arrow_up:[к оглавлению](README.md#Оглавление)

### Выводы:  

Итак, в ходе работы были выполнены все этапы проекта.

**Часть 3. Предобработка и очистка данных**
Данные были очищены от выбросов и дубликатов, логических выбросов.

**Часть 4. Разведывательный анализ данных:**
1. Построили визуалицации и поняли, клиенты из каких стран покупают чаще и больше.
2. Выяснили, что в ноябре в преддверии праздников спрос на подарки наибольший, выяснили, в какие дни чаще совершаются покупки, а также что больше всего заказов совершается в дневное время, в интервале от 10 до 15 часов, а с 21 часа до 6 утра (не включительно) заказы не поступают.

**Часть 5. RFM-сегментация клиентов. Снижение размерности методом PCA:**
1. Для каждого клиента составили RFM-профиль, где:
    * Recency (Давность) — давность последней покупки клиента;
    * Frequency (Частота) — общее количество покупок клиента;
    * Monetary Value (Денежная ценность) — сколько денег потратил клиент.
2. Применили метод снижения размерности PCA.
3. На основании максимального значения коэффициента силуэта из 2 методов кластеризации (KMeans/EM) лучшим оказался KMeans для 3 кластеров. 
4. Визуализировали результаты, а также построили полярную диаграмму.
    Для этого случая клиентов можно разделить на следующие кластеры:
    * Кластер 1 соответствует «лояльным» клиентам, которые приносят наибольший доход, совершают покупки чаще всего, а давность их последней покупки наименьшая.
    * Кластер 2 соответствует «промежуточным» клиентам, которые являются активными, но покупают не так часто и много, как лояльные клиенты. В то же время эти клиенты не являются «потерянными».
    * Кластер 0 соответствует «потерянным» клиентам, которые купили меньше всего товара, и их последняя покупка была совершена очень давно.


**Часть 6. RFM-сегментация клиентов. Снижение размерности методом t-SNE:**
1. Применили метод снижения размерности t-SNE.
2. На основании максимального значения коэффициента силуэта из 3 методов кластеризации (KMeans/EM/AgglomerativeClustering) лучшим оказался KMeans для 7 кластеров.
3. Визуализировали результаты, а также построили полярную диаграмму.
    Для этого случая клиентов можно разделить на следующие кластеры:
    * Кластер 1 соответствует «лояльным» клиентам, которые приносят наибольший доход, совершают покупки чаще всего, а давность их последней покупки наименьшая.
    * Кластер 4 соответствует «перспективным» клиентам, которые являются активными покупателями, но покупают не так часто и не так много, как лояльные клиенты.
    * Кластер 2 соответствует «подвисшим» клиентам, которые относительно недавно сделали несколько заказов на небольшие суммы. Потенциально эти клиенты могут быть переведены в кластер «перспективных».
    * Кластер 5 соответствует клиентам «в зоне риска», которые несколько раз покупали товары на небольшие суммы, однако их последняя покупка была совершена более пяти месяцев назад.
    * Кластер 0 соответствует клиентам-«новичкам», которые относительно недавно сделали один заказ на небольшую сумму. 
    * Кластер 6 соответствует «спящим» или «почти потерянным» клиентам, которые сделали один заказ на маленькую сумму более семи месяцев назад и больше не возвращались.
    * Кластер 3 соответствует «потерянным» клиентам, которые купили меньше всего товара, и их последняя покупка была совершена около года назад.

**Часть 7. RFM-сегментация клиентов. Построение предсказательных моделей:**
1. Мы построили модель кластеризации для части клиентов. Теперь нужно сделать предсказание сегмента для клиентов, которые не попали в обучающую выборку.
Нужно помнить, что мы обучали наши алгоритмы кластеризации на сжатом с помощью t-SNE пространстве признаков. То есть, чтобы сделать предсказание для новых объектов, не попавших в выборку, нам необходимо будет совершить трансформацию признаков этих объектов в новое сжатое пространство. Однако проблема t-SNE заключается в том, что алгоритм непараметрический. Это значит, что он, в отличие от таких алгоритмов, как PCA и SVD, не создаёт явной функции отображения. Т.е. алгоритм трансформирует пространство признаков для обучающей выборки, но не запоминает, каким образом это делает. Это значит, что, передав в алгоритм новые объекты для сжатия пространства, мы получим абсолютно новое представление пространства, не имеющее отношения к тому, что мы построили для обучающей выборки. То есть произойдёт искажение, что может привести к неверным результатам кластеризации.

Тогда сведём задачу кластеризации к задаче классификации. У нас теперь есть истинные метки кластеров, а есть клиенты, которые описываются RFM-характеристиками. Обучим модель, которая на основе RFM-характеристик будет предсказывать клиентский сегмент. 
2. Построена модель случайного леса. С помощью GridSearchCV с помощью кросс-валидации на 5 фолдах проведена оптимизация гиперпараметров и для лучшей модели посчитана метрика accuracy (0.985).
3. Построена модель GB над деревьями решений. С помощью GridSearchCV с помощью кросс-валидации на 5 фолдах проведена оптимизация гиперпараметров и для лучшей модели посчитана метрика accuracy (0.983).

**Вывод:**

Все этапы задачи выполнены, сформирован RFM-профиль пользователей. На его основании проверено два метода понижения размерности, для каждого метода с помощью коэффициента силуэта подобран оптимальный алгоритм кластеризации и количество кластеров. С помощью полярной диаграммы клиенты разнесены по кластерам.
Построены модели, которые с высокой точностью на основании RFM-профиля новых пользователей могут определять кластер клиента, что позволит повысить качество работы с клиентами.

В качестве перспективных направлений можно выделить следующие:

1. Выделить оптовиков в отдельный сегмент. В таком случае идея метода RFM расширяется путём добавления в датасет информации о среднем количестве покупаемого товара за один заказ. То есть аббревиатура RFM превращается в RFMQ, где Q — среднее количество товаров в одном заказе.
2. Произвести кластерный анализ товаров на основе их описания и сформировать категории, по которым совершаются покупки.
3. Рассчитать частоту покупки каждой категории товаров для каждого клиента. Эта информация может стать основой для построения модели кластеризации и сегментирования клиентов по их интересам.
4. Воспользоваться информацией о сезонности покупок и добавить в модель информацию о частоте покупок клиентов в каждый из месяцев. Так можно определить, какие клиенты являются постоянными, то есть их покупки не зависят от сезона, а какие покупают товары только в преддверии праздников. Эта информация позволит экспериментировать с маркетинговой кампанией и повышать лояльность клиентов.

:arrow_up:[к оглавлению](README.md#Оглавление)

