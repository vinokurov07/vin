# PROJECT-4. Задача классификации. Определение вероятности выдачи депозита клиентам банка

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[3. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[4. Результаты](README.md#Результаты)    
[5. Выводы](README.md#Выводы) 

### Описание проекта  

Банки хранят огромные объёмы информации о своих клиентах. Эти данные можно использовать для того, чтобы оставаться на связи с клиентами и индивидуально ориентировать их на подходящие именно им продукты или банковские предложения.

Обычно с выбранными клиентами связываются напрямую через разные каналы связи: лично (например, при визите в банк), по телефону, по электронной почте, в мессенджерах и так далее. Этот вид маркетинга называется прямым маркетингом. На самом деле, прямой маркетинг используется для взаимодействия с клиентами в большинстве банков и страховых компаний. Но, разумеется, проведение маркетинговых кампаний и взаимодействие с клиентами — это трудозатратно и дорого.
Банкам хотелось бы уметь выбирать среди своих клиентов именно тех, которые с наибольшей вероятностью воспользуются тем или иным предложением, и связываться именно с ними.

Вам предоставили данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Вы должны проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. Если вы сможете это сделать, то поднимете доходы банка и поможете понять целевую аудиторию, которую необходимо привлекать путём рекламы и различных предложений.

Бизнес-задача: определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

Техническая задача: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Краткая информация о данных

Данные принадлежат реальному банку.

***Имеющиеся данные:***

**Данные о клиентах банка:**

age (возраст);  
job (сфера занятости);  
marital (семейное положение);  
education (уровень образования);  
default (имеется ли просроченный кредит);  
housing (имеется ли кредит на жильё);  
loan (имеется ли кредит на личные нужды);  
balance (баланс).  

**Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:**

contact (тип контакта с клиентом);
month (месяц, в котором был последний контакт);
day (день, в который был последний контакт);
duration (продолжительность контакта в секундах).

**Прочие признаки:**

campaign (количество контактов с этим клиентом в течение текущей кампании);
pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
previous (количество контактов до текущей кампании)
poutcome (результат прошлой маркетинговой кампании).

И целевая переменная deposit, которая определяет, согласится ли клиент открыть депозит в банке. Её нужно предсказать в данном кейсе.
  
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  

3.1 Первичная обработка данных

    В рамках этой части обработаем пропуски и выбросы в данных. Это необходимо для дальнейшей работы с ними.

3.2 Разведывательный анализ данных (EDA)

    Необходимо будет исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.

3.3 Отбор и преобразование признаков

    На этом этапе нужно перекодировать и преобразовать данные таким образом, чтобы их можно было использовать при решении задачи классификации.

3.4 Решение задачи классификации: логистическая регрессия и решающие деревья

    На данном этапе построим прогностические модели и оценим её качество. Подберем оптимальные параметры модели для того, чтобы получить наилучший результат для конкретного алгоритма.

3.5 Решение задачи классификации: ансамбли моделей и построение прогноза

    На заключительном этапе доработаем своё предсказание с использованием более сложных алгоритмов и оценим, с помощью какой модели возможно сделать более качественные прогнозы.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Результаты
Весь проект выполнен в шаблоне-ноутбуке (https://github.com/vinokurov07/vin/blob/main/SkillFactory/Project%202/Project_2_%D0%9D%D0%BE%D1%83%D1%82%D0%B1%D1%83%D0%BA_%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD.ipynb)


:arrow_up:[к оглавлению](README.md#Оглавление)


### Выводы:  

Вывод: итак, в ходе работы были выполнены все этапы проекта.

1. Первичная обработка данных.
Данные были изучены, приведены к виду, с котовым можно работать в дальнейшем (удалены лишние символы). Данные проверены на предмет пропусков. Помимо явных пропусков (как в признаке Balance), наблюдались неявные пропуски в категориальных признаках (Education, Job). Для числового признака пропуски были заменены медианным значением, а для категориальных - модальным. 

2. Разведывательный анализ данных (EDA).
На втором этапе были изучены описательные статистики для категориальных и числовых признаков. Построены графики для визуализации распределения и взаимосвязи между числовыми признаками, а также для категориальных построены столбчатые диаграммы распределения признака по категориям и соотношения людей в каждой категории в зависимости от целевого признака (какая доля людей в каждой категории признака открыла депозит). 
Мы увидели, что депозиты чаще открывают молодые люди и пенсионеры, чем другие возрастные категории. Но в численном выражении больше депозитов открыли люди в возрасте 30-40 лет, хотя это и самая распространенная категория людей и только чуть более 40% таких людей открывает депозиты.
Также одинокие и разведенные люди чаще открывают депозит, чем женатые.
Студенты и пенсионеры чаще открывают депозит, чем другие категории, что коррелирует с утверждением выше.
Кроме того, люди с высшим образованием окрывают депозиты чаще, чем люди со средним и начальным, так что, скорее всего, финансовая грамотность коррелирует с уровнем образования. А может быть люди с высшим образованием больше зарабатывают и могут позволить откладывать свободные деньги.
В комбинации людей по уровню образования и семеному статусу в разрезе целевого признака однозначные выводы сделать трудно. Между комбинациями этих признаков есть корреляция: одни и те же группы как открывают депозиты, так и не открывают.

3. Преобразование данных
На этом этапе были выполнены некоторые преобразования признаков, например из признака возраста для удобства анализа был сформирован признак с возрастными категориями, т.к. сам по себе признак возраста имеет много уникальных значений и не похходит для работы.
Также для подачи данных в модель машинного обучения данные были закодированы. Порядковые категориальные переменные закодированы с помощью порядкового кодирования, номинальные - с помощью однократного кодирования. 
Кроме того, значения бинарных переменные были выражены через 1 и 0.

4. Решение задачи классификации: логистическая регрессия и решающие деревья
задача регрессии была решена с помощью двух моделей: линейной регрессии и дерева решений. Обе модели показали одинаковые метрики f1-score (0.78) и accuracy(0.80) (при учете подбора оптимальных гиперпараметров для модели дерева решений с помощью метода GridSearch, т.к. без этого модель предсказуемо ушла в переобучение)

5. Ансамбли моделей и построение прогноза
На этом этапе задача решалась более сложными моделями - с помощью моделей случайного леса и градиентвного бустинга над деревом решений. Модель градиентного бустинга показала метрики f1-score = 0.81 и accuracy = 0.82. Чуть лучше справилась модель случайного леса, f1-score = 0.82 и accuracy = 0.83. В целом модель одинакого хорошо определяет отношение к классу 1 и к классу 0, т.к. выборка данных была сбалансирована по целевому признаку.
Кроме того, был проверен алгоритм стекинга. В качестве базовых моделей применялись алгоритмы, которые уже использовали ранее: решающие деревья, логистическая регрессия и градиентный бустинг. В качестве метамодели использовалась модель логистической регрессии. Результаты получились аналогичны модели случайного леса.
Также, для модели случайного леса были подобраны оптимальные гиперпараметры с помощью Optuna. Однако, после обучения модели на оптимальных гиперпараметрах поднять качество не удалось, метрики остались на прежних значениях.

Итого, задача решена, теперь модель по имеющимся признакам клиентов может с высоким качеством предстказать, откроет клиент депозит или нет.

:arrow_up:[к оглавлению](README.md#Оглавление)

