# PROJECT-8. Прогнозирование времени поездки на такси 

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[3. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[4. Результаты](README.md#Результаты)    
[5. Выводы](README.md#Выводы) 

### Описание проекта  

Нужно решить задачу машинного обучения, направленную на автоматизацию бизнес процессов. Нужно построить модель, которая будет предсказывать общую продолжительность поездки такси в Нью-Йорке. 

Представьте вы заказываете такси из одной точки Нью-Йорка в другую, причем не обязательно конечная точка должна находиться в пределах города. Сколько вы должны будете за нее заплатить? Известно, что стоимость такси в США  рассчитывается на основе фиксированной ставки + тарифная стоимость, величина которой зависит от времени и расстояния. Тарифы варьируются в зависимости от города.

В свою очередь время поездки зависит от множества факторов таких как, откуда и куда вы едете, в какое время суток вы совершаете вашу поездку, погодных условий и так далее. 

Таким образом, если мы разработаем алгоритм, способный определять длительность поездки, мы сможем прогнозировать ее стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф. 
Сервисы такси хранят огромные объёмы информации о поездках, включая такие данные как конечная, начальная точка маршрута, дата поездки и ее длительность. Эти данные можно использовать для того, чтобы прогнозировать длительность поездки в автоматическом режиме с привлечением искусственного интеллекта.

**Бизнес-задача:** определить характеристики и с их помощью спрогнозировать длительность поездки такси.

**Техническая задача для специалиста в Data Science:** построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак - время поездки такси. То есть решить задачу регрессии.

**Основные цели проекта:**
1. Сформировать набор данных на основе нескольких источников информации
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели
3. Исследовать предоставленные данные и выявить закономерности
4. Построить несколько моделей и выбрать из них наилучшую по заданной метрике
5. Спроектировать процесс предсказания времени длительности поездки для новых данных

:arrow_up:[к оглавлению](README.md#Оглавление)


### Краткая информация о данных

У нас есть данные о почти 1.5 миллионах поездок и 11 характеристиках, которые описывают каждую из поездок.
Тренировряные и тестовые данные представлены отдельными файлами.

***Имеющиеся данные:***

Разделим признаки нескольких групп. Каждой из групп мы в дальнейшем уделим отдельное внимание.

**Данные о клиенте и таксопарке:**
* id - уникальный идентификатор поездки
* vendor_id - уникальный идентификатор поставщика (таксопарка), связанного с записью поездки

**Временные характеристики:**
* pickup_datetime - дата и время, когда был включен счетчик поездки
* dropoff_datetime - дата и время, когда счетчик был отключен

**Географическая информация:**
* pickup_longitude -  долгота, на которой был включен счетчик
* pickup_latitude - широта, на которой был включен счетчик
* dropoff_longitude - долгота, на которой счетчик был отключен
* dropoff_latitude - широта, на которой счетчик был отключен

**Прочие признаки:**
* passenger_count - количество пассажиров в транспортном средстве (введенное водителем значение)
* store_and_fwd_flag - флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику. Y - хранить и пересылать, N - не хранить и не пересылать поездку.

**Целевой признак:**
* trip_duration - продолжительность поездки в секундах
  
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  

1. Знакомство с данными, базовый анализ и расширение данных

    В рамках этой части:
    * познакомимся с данными, исследуем на пропуски, выбросы
    * посмотрим на распределения и статистические характеристики некоторых признаков
    * проведем Feature Engineering

2. Разведывательный анализ данных (EDA)

    В этой части проекта:
    * Исследуем сформированный набор данных; 
    * Попробуем найти закономерности, позволяющие сформулировать предварительные гипотезы относительно того, какие факторы являются решающими в определении длительности поездки;
    * Дополним анализ визуализациями, иллюстрирующими исследование.

3. Отбор и преобразование признаков

    * Закодируем категориальные признаки;
    * отберемотобрать признаки, которые мы будем использовать для обучения модели;
    * Масштабируем и трансформируем некоторые признаки.

4. Решение задачи регрессии: линейная регрессия и деревья решений

    * Линейной регрессии
    * Полиномиальной регрессии
    * Деревья решений

5. Ансамблевые методы

    Построим модели:
    * Случайного леса
    * Градиентного бустинга над деревом решений
    * XGBoost

    Посмотрим на важность признаков, обработаем тестовый датасет для приведения его к формату тренировочного, и сделаем предсказания.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Результаты
[Весь проект выполнен в ноутбуке](</Projects/Project 6/Project 6.ipynb>)


:arrow_up:[к оглавлению](README.md#Оглавление)

### Выводы:  

Вывод: итак, в ходе работы были выполнены все этапы проекта.
Обработаны пропуски, выбросы. Рассмотрены статистические характеристики признаков, созданы новые признаки.
Построены визуализации для лучшего понимания зависимостей в данных.
Категориальные признаки были закодированы, из признаков в формате дат была получена доп. информация. Отобраны признаки для обучения модели. Признаки были стандартизированы. Обучающая выборка была разделена на тренировочную и валидационную. Т.к. все преобразования признаков для train/valid были выполнены в виде функций, это позволило легко преобразовать тестовую выборку для соответствия формату тренировочной.  
Основной метрикой качества решения поставленной задачи была RMSLE (Root Mean Squared Log Error), которая вычисляется на основе целевой переменной в логарифмическом масштабе.

В таком случае целесообразно сразу логарифмировать признак длительности поездки и рассматривать при анализе логарифм в качестве целевого признака:
Были обучены модели:
* Линейной регрессии
* Полиномиальной регрессии
* Деревья решений
* Случайного леса
* Градиентного бустинга над деревом решений
* XGBoost
Лучшие результаты по метрике Root Mean Squared Log Error показада модель XGBoost. Для последних двух моделей были определены наиболее важные признаки, и как мы убедились, для разных моделей разный топ признаков по важности.

При построении модели целевая переменная была логарифмирована, поэтому для оценки результата предсказания модели были возвращены обычный (не логарифмированный) масштаб и посчитана метрика медианной абсолютной ошибки (MeAE). Это хорошая метрика для данной задачи, т.к. имеет устойчивость к выбросам. В данных о поездках могут быть аномально долгие поездки (пробки, неправильно введенный адрес и т.д.). MedAE, в отличие от MAE (средней абсолютной ошибки) и особенно RMSE, очень устойчива к таким выбросам. Она показывает типичную ошибку для "нормальной" поездки.
MedAE = 1.8 минуты — это прекрасный результат для задачи прогнозирования времени поездки. Это означает, что для половины поездок в валидационной выборке ошибка предсказания составляет меньше 1.8 минут, а для другой половины — больше.

:arrow_up:[к оглавлению](README.md#Оглавление)

